name: Morning Workflow
on:
  push:
    branches: [main]
  schedule:
    - cron: "0 22 * * *"

jobs:
  toggle:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2
        with:
          repository: 2-Rq-2/Railway-Games  # 替换为您的仓库地址

      - name: Configure Git
        run: |
          git config --global user.name "2-Rq-2"
          git config --global user.email "loslao11@mailbox.org"
          git config --global credential.helper store

      - name: Check File Existence
        run: |
          current_hour=$(TZ='Asia/Singapore' date +"%H")
          if [[ $current_hour -ge 6 && $current_hour -lt 21 ]]; then
            if [[ -f "app2.js" ]]; then
              if [[ -f "app.js" ]]; then
                rm -f app.js  # 删除 app.js 文件
                echo "Deleted app.js"
              fi
              mv app2.js app.js  # 重命名 app2.js 为 app.js
              echo "Switched to app.js"
              git add app.js
              git commit -m "Switched to app.js" || true
              git push origin HEAD
            else
              echo "app2.js not found, skipping file switch"
            fi
          else
            echo "Skipping file switch"
          fi

      - name: Clean Up Extra Files
        run: |
          if [[ -f "app2.js" ]]; then
            rm -f app2.js  # 删除 app2.js 文件
            echo "Deleted app2.js"
          fi
